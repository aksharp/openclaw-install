{{- if and .Values.observability.enabled .Values.observability.alertmanager.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "openclaw.alertmanager.fullname" . }}-config
  namespace: {{ include "openclaw.namespace" . }}
  labels:
    {{- include "openclaw.labels" . | nindent 4 }}
    app.kubernetes.io/component: alertmanager
data:
  alertmanager.yml: |
    {{- if .Values.observability.alertmanager.config }}
    {{- toYaml .Values.observability.alertmanager.config | nindent 4 }}
    {{- else }}
    global: {}
    route:
      receiver: 'null'
      group_by: ['alertname']
      group_wait: 30s
      group_interval: 5m
      repeat_interval: 4h
    receivers:
      - name: 'null'
    {{- end }}
{{- end }}
